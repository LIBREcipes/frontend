<form
  [formGroup]="form"
  (ngSubmit)="onSubmit()"
  cdkDropList
  (cdkDropListDropped)="stepDropped($event)"
>
  <app-form-error
    [action]="errorType"
    (active)="isLoading = false"
  ></app-form-error>
  <div
    class="message"
    formArrayName="steps"
    *ngFor="let control of steps.controls; let i = index"
    cdkDrag
  >
    <div class="message-header" *cdkDragPreview>
      <p>Step {{ i + 1 }}</p>
    </div>
    <div
      class="has-background-info"
      style="height: 2px;"
      *cdkDragPlaceholder
    ></div>
    <div class="message-header" cdkDragHandle>
      <p>
        <span class="icon"><i class="fa fa-bars"></i></span>Step
        {{ i + 1 }}
      </p>
      <button
        class="delete"
        aria-label="delete"
        (click)="removeForm(i)"
      ></button>
    </div>
    <div class="message-body" [formGroupName]="i">
      <input type="hidden" formControlName="id" />
      <div class="field is-horizontal">
        <div class="field-label">
          <label class="label">Description</label>
        </div>
        <div class="field-body">
          <div class="field">
            <div class="control">
              <textarea
                class="textarea"
                formControlName="description"
              ></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="field is-grouped is-grouped-right">
    <div class="control">
      <button
        class="button is-small is-outlined"
        type="button"
        (click)="addForm()"
      >
        <i class="fa fa-plus"></i>
      </button>
    </div>
  </div>

  <div class="field">
    <div class="control">
      <button
        class="button is-primary"
        [class.is-loading]="isLoading"
        type="submit"
        [disabled]="!form.valid"
      >
        Save
      </button>
    </div>
  </div>
</form>
